# Colocalization_by_Cross_Correlation
Installing the Plugin:
This plugin requires an additional imglib2 library that does not come by default with ImageJ/FIJI. You can download the file here: https://mvnrepository.com/artifact/net.imglib2/imglib2-script/0.2.3
Drag and drop the imglib2-script file into the "jars" folder of ImageJ/FIJI, and put the plugin file into the "Plugins" folder. 
Preparing images:
This plugin requires two single channel, single frame images (2D or 3D) to be analyzed, and an additional binary mask to define the randomization area (details for mask below). The two images should undergo appropriate background subtraction to lower the background pixel values to zero or near zero. Even low level background (pixel values of 10 to 20 on a 16 bit image) can lower the confidence level and result in false negatives. Additionally, the images (particularly 3D) need to be correctly scaled (Image>Properties), otherwise all axes will be assumed to have the same scale. 
The mask for the binary image should cover all of the theoretically possible localizations for the signals in the images. Typically this will simply be a binary mask of the cell volume, however if you are analyzing nuclear proteins, this would be a mask of only the nuclei. Using an inappropriate mask will likely result in the detection of a strong correlation caused by these higher order repeating structures (e.g. you will find a correlation at distances averaging 10-15 microns, caused by the ordered structure of the cell). 
Running the plugin:
The plugin can be found in the plugins menu (currently near the bottom) and should be started with the images and mask already open. At the menu, select the two images and the mask to be used, and enter the PSF width and height in pixel units. For the Costes’ randomization cycles count, you can typically input a low number (3-5), however if you have sparse signal within a large mask volume you will probably want to do more cycles (~10). If the “Show intermediate data” box is checked, the plugin will open images showing the correlations (before and after subtraction of random associations), and a sample randomization image. This can be useful for understanding the function of the plugin, or for visualizing the direction of the correlation if your sample has a polarized axis (e.g. endothelial cells grown under flow). 
Interpreting the results:
After the plugin has finished, four new windows will be open:
1.	Correlation plot: A radial profile plot will be displayed, it contains the radial profile of the original correlation image (black line), the radial profile of the correlation after subtraction of random associations (red line), and a Gaussian curve fit to the subtracted profile (blue dots). The Y-axis is the result of the average correlation function at a given distance. While not arbitrary, it is most easily viewed as a measure of relative correlation. The range of the graph is set automatically to fit the Gaussian curve. If you wish to view all the data select More>Set Range to Fit all… 
2.	Gaussian fit analysis: This text window will contain (in scaled units), the mean distance for the discovered correlation, and the standard deviation of that correlation (sigma), as well as an estimation of confidence for this correlation (range 0-100). The confidence is determined by taking the area under the curve (AUC) of the subtracted correlation radial profile (in range of mean ± 3×sigma) divided by the AUC of the original correlation radial profile (in same range). Values closer to 100 indicate a strong likelihood of true correlation. Values near zero indicate low to no correlation between the two images. We estimate that values of ~20 or greater indicate some degree of correlation (within the range specified by the Gaussian curve). 
3.	Approximate images of correlating signal: In the event that only a subset of particles correlate, two images will appear that give an estimate of the localization of these correlating particles (the brightest parts of the image). However, in addition to being noisy, I have found that these images often contain both false positives and false negatives, thus they should be used only as a loose guide for determining the correlating particles in the original images.
